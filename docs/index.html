<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Modularize</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1{font-size:1.7em;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project >section img{max-width:100%;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:8em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.project #system #author label{vertical-align:top;}article.project #system #author ul{display:inline-block;margin:0;padding:0;list-style:none;}article.project #toc nav>*{margin-left:1em;display:block;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;}@media (min-width: 1300px){html body{padding-left:16em;}article.project #toc{margin:0;position:fixed;left:0;top:0;bottom:0;width:15em;overflow-y:auto;background:#F0F0F0;border-right:1px solid #A0A0A0;}}</style> </head> <body> <article class="project"> <header>   <h1>modularize</h1>   <span class="version">1.0.0</span>    <p class="description">A modularization framework</p>   </header> <section id="toc"> <h2>Table of Contents</h2> <nav> <a href="#project">Top</a>  <a href="#documentation">Documentation</a> <nav> <a href="#about_modularize">About Modularize</a>  <a href="#how_to">How To</a> </nav>  <a href="#system">System</a>  <a href="#system">Packages</a> <nav> <a href="#PACKAGE%20MODULARIZE">MODULARIZE</a>  <a href="#PACKAGE%20ORG.SHIRAKUMO.RADIANCE.LIB.MODULARIZE.USER">ORG.SHIRAKUMO.RADIANCE.LIB.MODULARIZE.USER</a> </nav>  </nav> </section>  <section id="documentation"><h2 id="about_modularize">About Modularize</h2> <p><code><a href="#FUNCTION%20MODULARIZE%3AMODULARIZE" class="xref">modularize</a></code> is an attempt at providing a common interface to segregate major application components. This is achieved by adding special treatment to packages. Each module is a package that is specially registered, which allows it to interact and co-exist with other modules in better ways. For instance, by adding module definition options you can introduce mechanisms to tie modules together in functionality, hook into each other, and so on.</p> <h2 id="how_to">How To</h2> <p>Each module should consist of a <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE" class="xref">define-module</a></code> form and an ASDF system with the superclass <code><a href="#FUNCTION%20MODULARIZE%3AMODULE" class="xref">modularize:module</a></code>. <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE" class="xref">define-module</a></code> acts as a wrapper around <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFPACKAGE" class="xref">defpackage</a></code>, so it will replace your usual <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFPACKAGE" class="xref">defpackage</a></code> form. Any option you would use in <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFPACKAGE" class="xref">defpackage</a></code> is also usable in <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE" class="xref">define-module</a></code>, but the latter also allows for custom-defined options that perform specific actions upon module creation.</p> <pre><code><a href="http://l1sp.org/cl/or" class="xref">(</a><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE" class="xref">modularize:define-module</a> test-module
  (:use #:cl #:modularize)
  (:export #:greet))</code></pre> <p>If for some reason you absolutely do not want to use <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE" class="xref">define-module</a></code>, you may define your package manually and call <code><a href="#FUNCTION%20MODULARIZE%3AMODULARIZE" class="xref">modularize</a></code> on it afterwards. Note though that you also need to manually perform all changes that additional module options may otherwise perform for you. If your module-name somehow differs from the ASDF system, you will need to specify this in your ASDF system definition:</p> <pre><code>(asdf:defsystem some-test-module
  :class &quot;modularize:virtual-module&quot;
  :defsystem-depends-on (:modularize)
  :module-name &quot;test-module&quot;
  ...)</code></pre> <p>The main difference from packages is that each module has a central storage table, which you can access with <code><a href="#FUNCTION%20MODULARIZE%3AMODULE-STORAGE" class="xref">module-storage</a></code>. This allows you to save metadata on modules to keep track of the different parts each module might play in your application.</p> <p>Another function that might prove useful is <code><a href="#FUNCTION%20MODULARIZE%3ADELETE-MODULE" class="xref">delete-module</a></code>, which attempts to offer a mechanism to completely remove a module so as to revert its changes. Without any further additions, this will simply result in all symbols in the module package being <code><a href="#FUNCTION%20MODULARIZE%3AMAKUNBOUND" class="xref">makunbound</a></code> and <code><a href="#FUNCTION%20MODULARIZE%3AFMAKUNBOUND" class="xref">fmakunbound</a></code> and the package getting deleted. Since a module might also cause changes outside of its own package, it is therefore advised to add deletion hooks through <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-DELETE-HOOK" class="xref">define-delete-hook</a></code>, so as to make sure other kinds of changes can be cleaned up as well.</p> <p>Similarly, if you want to tack on functionality to initialize a module once it is defined, you can hook into that with <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULARIZE-HOOK" class="xref">define-modularize-hook</a></code> and <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-OPTION-EXPANDER" class="xref">define-option-expander</a></code>. The former works like <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-DELETE-HOOK" class="xref">define-delete-hook</a></code>, and is called once <code><a href="#FUNCTION%20MODULARIZE%3AMODULARIZE" class="xref">modularize</a></code> is called on a package after the package's storage has been set up. The latter allows you to declare custom forms that a <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE" class="xref">define-module</a></code> call should expand to. Note that module options are only expanded <em>after</em> <code><a href="#FUNCTION%20MODULARIZE%3AMODULARIZE" class="xref">modularize</a></code> is called, so you may use the storage in your expansions.</p> <p>If a component should extend the functionality of another, this can be more intuitively done through <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE-EXTENSION" class="xref">define-module-extension</a></code>. In looks and form it is the same as <code><a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE" class="xref">define-module</a></code>, with the difference that it won't create a new package, but use the one it is extending. Through this you can export new functions and other additions without running into a multiple-package mess.</p> <p>If you would like to group multiple packages under a single module (probably the case if you use one package per file), then you must register the packages with the module. You can do this in your module definition with the <code>:packages</code> option, or by <code><a href="#FUNCTION%20MODULARIZE%3AMODULE-PACKAGES" class="xref">module-packages</a></code> calls.</p> <p>For a super small sample use of a module, have a look at <a href="https://github.com/shinmera/modularize/blob/master/modularize-test-module.asd">modularize-test-module.asd</a> and <a href="https://github.com/shinmera/modularize/blob/master/modularize-test-module.lisp">modularize-test-module.lisp</a>. For extensions to the module system, have a gander at <a href="https://github.com/shinmera/modularize-interfaces">modularize-interfaces</a> and <a href="https://github.com/shinmera/modularize-hooks">modularize-hooks</a>.</p> </section>    <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">1.0.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external" href="https://Shinmera.github.io/documentation-utils/">documentation-utils</a></li><li><a class="external">trivial-package-local-nicknames</a></li></ul> </div>   <div class="row" id="author"> <label for="author">Author:</label> <a href="mailto:shinmera@tymoon.eu">Yukari Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/LICENSE">zlib</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://Shinmera.github.io/modularize/">https://Shinmera.github.io/modularize/</a> </div>   <div class="row"> <label for="bug-tracker">Bug Tracker:</label> <a id="bug-tracker" href="https://github.com/Shinmera/modularize/issues">https://github.com/Shinmera/modularize/issues</a> </div>   <div class="row"> <label for="sources">Sources:</label> <a id="sources" href="https://github.com/Shinmera/modularize.git">https://github.com/Shinmera/modularize.git</a> </div>  </section>    <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE MODULARIZE"> <header> <h3> <a href="#PACKAGE%20MODULARIZE">MODULARIZE</a> </h3> <ul class="nicknames"> <li>ORG.SHIRAKUMO.RADIANCE.LIB.MODULARIZE</li>  <li>RADIANCE-MODULARIZE</li> </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition class" id="CLASS MODULARIZE:MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20MODULARIZE%3AMODULE">MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/asdf.lisp#L31">Source</a>  </header> <div class="docstring"><pre>ASDF System subclass that serves as the class for virtual modules.

Deprecated-- use VIRTUAL-MODULE instead.</pre></div> </article> </li>  <li> <article class="definition class" id="CLASS MODULARIZE:VIRTUAL-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20MODULARIZE%3AVIRTUAL-MODULE">VIRTUAL-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/asdf.lisp#L27">Source</a>  </header> <div class="docstring"><pre>ASDF System subclass that serves as the class for virtual modules.</pre></div> </article> </li>  <li> <article class="definition condition" id="CONDITION MODULARIZE:MODULE-NOT-FOUND"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CONDITION</span> <h4 class="name"> <a href="#CONDITION%20MODULARIZE%3AMODULE-NOT-FOUND">MODULE-NOT-FOUND</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L6">Source</a>  </header> <div class="docstring"><pre>Condition signalled when a module is requested but not found.</pre></div> </article> </li>  <li> <article class="definition condition" id="CONDITION MODULARIZE:NOT-A-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CONDITION</span> <h4 class="name"> <a href="#CONDITION%20MODULARIZE%3ANOT-A-MODULE">NOT-A-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L10">Source</a>  </header> <div class="docstring"><pre>Condition signalled when a module is requested but only a package of the requested name exists.</pre></div> </article> </li>  <li> <article class="definition condition" id="CONDITION MODULARIZE:VIRTUAL-MODULE-NOT-FOUND"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CONDITION</span> <h4 class="name"> <a href="#CONDITION%20MODULARIZE%3AVIRTUAL-MODULE-NOT-FOUND">VIRTUAL-MODULE-NOT-FOUND</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/asdf.lisp#L23">Source</a>  </header> <div class="docstring"><pre>Condition signalled when a virtual module was requested but could not be found.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:CALL-DELETE-HOOKS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3ACALL-DELETE-HOOKS">CALL-DELETE-HOOKS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PACKAGE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L35">Source</a>  </header> <div class="docstring"><pre>Calls all deletion hooks on the package.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:CALL-MODULARIZE-HOOKS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3ACALL-MODULARIZE-HOOKS">CALL-MODULARIZE-HOOKS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PACKAGE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L15">Source</a>  </header> <div class="docstring"><pre>Calls all modularization hooks on the package.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:DELETE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3ADELETE-HOOK">DELETE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L26">Source</a>  </header> <div class="docstring"><pre>Accesses the deletion hook function associated with the identifier.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:(SETF DELETE-HOOK)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3A%28SETF%20DELETE-HOOK%29">(SETF DELETE-HOOK)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L29">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:DELETE-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3ADELETE-MODULE">DELETE-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L158">Source</a>  </header> <div class="docstring"><pre>Attempts to completely delete the given module.

This first calls the delete hooks, then demodularizes
the package, unbinds all symbols in the package from
values and functions, and finally deletes the package.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:DEMODULARIZE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3ADEMODULARIZE">DEMODULARIZE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L151">Source</a>  </header> <div class="docstring"><pre>Removes the module from the module storage table.

This essentially returning it back to a normal package.
Any additional effects by module options or
modularization hooks can of course not be undone by this.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:LIST-MODULES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3ALIST-MODULES">LIST-MODULES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L177">Source</a>  </header> <div class="docstring"><pre>Returns a list of all modules in no particular order.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:LOAD-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3ALOAD-MODULE">LOAD-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/asdf.lisp#L53">Source</a>  </header> <div class="docstring"><pre>Attempts to find the module named by identifier and load its ASDF system.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MAP-MODULES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMAP-MODULES">MAP-MODULES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L171">Source</a>  </header> <div class="docstring"><pre>Calls the function once with each module in no particular order.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULARIZE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULARIZE">MODULARIZE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">PACKAGE</li>    <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L134">Source</a>  </header> <div class="docstring"><pre>Turns the given package into one that is identified as a module.

What this does is register the package on the module
storage table, add the name and identifiers to it,
and then call the modularize hooks.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULARIZE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULARIZE-HOOK">MODULARIZE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L6">Source</a>  </header> <div class="docstring"><pre>Accessor to the modularization hook function associated with the identifier.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:(SETF MODULARIZE-HOOK)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3A%28SETF%20MODULARIZE-HOOK%29">(SETF MODULARIZE-HOOK)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L9">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULE">MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L38">Source</a>  </header> <div class="docstring"><pre>Attempts to return the matching module package.

If not possible, a condition of type MODULE-NOT-FOUND is signalled.

You may pass a STRING, SYMBOL or PACKAGE as the identifier.
If NIL is passed, the current *PACKAGE* is used instead.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULE-IDENTIFIER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULE-IDENTIFIER">MODULE-IDENTIFIER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L63">Source</a>  </header> <div class="docstring"><pre>Returns the identifier of the module.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULE-NAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULE-NAME">MODULE-NAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L66">Source</a>  </header> <div class="docstring"><pre>Returns the name of the module.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULE-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULE-P">MODULE-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L30">Source</a>  </header> <div class="docstring"><pre>Returns non-NIL if the passed object is or resolves to a module package, otherwise NIL.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULE-PACKAGES"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULE-PACKAGES">MODULE-PACKAGES</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L69">Source</a>  </header> <div class="docstring"><pre>Accesses the packages that are sub-packages under the module.

The list may contain package objects or package-names.

You can only add packages that are not already registered
as sub-packages to a module, and are not themselves a module.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:(SETF MODULE-PACKAGES)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3A%28SETF%20MODULE-PACKAGES%29">(SETF MODULE-PACKAGES)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">PACKAGES</li>    <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L72">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULE-STORAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULE-STORAGE">MODULE-STORAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">KEY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L50">Source</a>  </header> <div class="docstring"><pre>Accesses the module storage table of the module or a field from it if a key is passed.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:(SETF MODULE-STORAGE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3A%28SETF%20MODULE-STORAGE%29">(SETF MODULE-STORAGE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">VALUE</li>    <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">KEY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L55">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:MODULE-STORAGE-REMOVE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AMODULE-STORAGE-REMOVE">MODULE-STORAGE-REMOVE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument">KEY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L60">Source</a>  </header> <div class="docstring"><pre>Removes a key from the module storage table.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:REGISTER-VIRTUAL-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AREGISTER-VIRTUAL-MODULE">REGISTER-VIRTUAL-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/asdf.lisp#L38">Source</a>  </header> <div class="docstring"><pre>Registers the given module in the virtual module map.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:REMOVE-DELETE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AREMOVE-DELETE-HOOK">REMOVE-DELETE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L32">Source</a>  </header> <div class="docstring"><pre>Removes the deletion hook named by the identifier.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION MODULARIZE:REMOVE-MODULARIZE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20MODULARIZE%3AREMOVE-MODULARIZE-HOOK">REMOVE-MODULARIZE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L12">Source</a>  </header> <div class="docstring"><pre>Removes the modularization hook named by the identifier.</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION MODULARIZE:EXPAND-OPTION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20MODULARIZE%3AEXPAND-OPTION">EXPAND-OPTION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPE</li>    <li class="argument">PACKAGE</li>    <li class="argument">ARGS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L96">Source</a>  </header> <div class="docstring"><pre>Called to expand module options into forms.</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION MODULARIZE:REMOVE-VIRTUAL-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20MODULARIZE%3AREMOVE-VIRTUAL-MODULE">REMOVE-VIRTUAL-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Removes the association of the name with a virtual module.</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION MODULARIZE:VIRTUAL-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20MODULARIZE%3AVIRTUAL-MODULE">VIRTUAL-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accesses the virtual module instance associated with the identifier if one was found, otherwise NIL.</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION MODULARIZE:(SETF VIRTUAL-MODULE)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20MODULARIZE%3A%28SETF%20VIRTUAL-MODULE%29">(SETF VIRTUAL-MODULE)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">MODULE</li>    <li class="argument">IDENTIFIER</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION MODULARIZE:VIRTUAL-MODULE-NAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20MODULARIZE%3AVIRTUAL-MODULE-NAME">VIRTUAL-MODULE-NAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Returns the module name associated with this virtual module.</pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION MODULARIZE:(SETF VIRTUAL-MODULE-NAME)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20MODULARIZE%3A%28SETF%20VIRTUAL-MODULE-NAME%29">(SETF VIRTUAL-MODULE-NAME)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION MODULARIZE:CURRENT-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20MODULARIZE%3ACURRENT-MODULE">CURRENT-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L93">Source</a>  </header> <div class="docstring"><pre>Macro that expands to the module in the current package.
Useful to establish a module context.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION MODULARIZE:DEFINE-DELETE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-DELETE-HOOK">DEFINE-DELETE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">MODULEVAR</li>  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>  <li class="argument">IDENTIFIER</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L39">Source</a>  </header> <div class="docstring"><pre>Defines a new deletion hook.

The identifier is defaulted to a keyword representation of the current package name.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION MODULARIZE:DEFINE-MODULARIZE-HOOK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULARIZE-HOOK">DEFINE-MODULARIZE-HOOK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">MODULEVAR</li>  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>  <li class="argument">IDENTIFIER</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/hooks.lisp#L19">Source</a>  </header> <div class="docstring"><pre>Defines a new modularization hook.

The identifier is defaulted to a keyword representation of the current package name.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION MODULARIZE:DEFINE-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE">DEFINE-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">OPTIONS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L109">Source</a>  </header> <div class="docstring"><pre>Defines a new module.

This essentially defines a new package with the given name,
calls MODULARIZE on it and then expands all options to extend
the package/module.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION MODULARIZE:DEFINE-MODULE-EXTENSION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-MODULE-EXTENSION">DEFINE-MODULE-EXTENSION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">MODULE-IDENTIFIER</li>  <li class="argument">NAME</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">OPTIONS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L119">Source</a>  </header> <div class="docstring"><pre>Defines a module extension.

This gives the existing module new nicknames and expands the
given options on it to add functionality.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION MODULARIZE:DEFINE-OPTION-EXPANDER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20MODULARIZE%3ADEFINE-OPTION-EXPANDER">DEFINE-OPTION-EXPANDER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <ul class="arguments"> <li class="argument">PACKAGE</li>  <li class="argument lambda-list-keyword">&amp;REST</li>  <li class="argument">ARGUMENTS</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L98">Source</a>  </header> <div class="docstring"><pre>Defines a new option expander that is called whenever the option is used in the module definition.

This should run whatever is necessary to accomplish the
desired option effect. The expanders are run AFTER the
modularize call, so you can use the module storage in
your expansions.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION MODULARIZE:WITH-MODULE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20MODULARIZE%3AWITH-MODULE">WITH-MODULE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">VAR</li>  <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>  <li class="argument">MODULE</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/modularize/blob/0548f2c5748d1b657ba5ae9c650efabb705b8583/module.lisp#L46">Source</a>  </header> <div class="docstring"><pre>Binds the resolved MODULE to VAR.</pre></div> </article> </li> </ul> </article> </li>  <li> <article class="definition package" id="PACKAGE ORG.SHIRAKUMO.RADIANCE.LIB.MODULARIZE.USER"> <header> <h3> <a href="#PACKAGE%20ORG.SHIRAKUMO.RADIANCE.LIB.MODULARIZE.USER">ORG.SHIRAKUMO.RADIANCE.LIB.MODULARIZE.USER</a> </h3> <ul class="nicknames"> <li>MODULARIZE-USER</li> </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"></ul> </article> </li> </ul> </section>  </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 